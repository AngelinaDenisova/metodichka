#include <iostream>
#include <Windows.h>
#include <string>
using namespace std;

int n = 0;
string s = "";
bool vskr = false, nesch1 = false, doch = false, vrach1 = false, vrach2 = false, vaza = false, vrach3 = false, kitch = false, otdel1 = false;

void hall(int n);
void room(int n);
void bathroom(int n);
void doorway(int n);
void entrance(int n);
void kitchen(int n);
void qvit(int n);
void coridor(int n);
void otdel(int n);
void poisk(int n);
void ub(int n);
void nesch(int n);
void tel(int n);

int main()
{
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);

    cout << "Чикаго, 1990 год, 5 декабря. В мотеле на окраине города было обнаружено тело молодой девушки. Об этом в милицию сообщила горничная мотеля, которая и нашла девушку мёртвой. \nВы - детектив, ваша задача - установить причину смерти и провести расследование. Отнеситесь к этому серьезно, ведь убийца гуляет на свободе. " << endl;
    system("pause");
    doorway(n);
}

void tel(int n) {
    system("cls");
    cout << "Вы узнаете, что девушка недавно посещала поликлинику, но ей отказали в приёме из-за отсутствия документов. \nВ больнице остался только номер телефона и её имя - Эмма." << endl;
    system("pause");
    vrach3 = true;
    coridor(n);
}

void doorway(int n)
{
    system("cls");
    cout << "Вы уже стоите у двери в её номер. Сразу зайдете, или попробуете поискать улики?" << endl;
    cout << "ПОИСКАТЬ УЛИКИ(1) или ЗАЙТИ(2)" << endl;

    do
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2 && n != 3);

    if (n == 1)
        entrance(n);
    if (n == 2)
        hall(n);

}


void entrance(int n)
{
    system("cls");
    cout << "В холле мотеля достаточно грязно. Не удивительно, это окраина города, часто здесь ошиваются не самые благополучные лица\nНо что же здесь забыла жертва? Кто она?" << endl;
    cout << "ОСМОТРЕТЬ ЗАМОК (1) или ЗАЙТИ(2)" << endl;
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    if (n == 1) {
        system("cls");
        cout << "Замок не имеет следов вскрытия и взлома. По словам горничной, когда она пришла, дверь было открыта. Это наталкивает на некоторые мысли…\n";
        vskr = true;
        system("pause");
    }
    hall(n);


}


void hall(int n) {
    system("cls");
    cout << "Вы заходите номер. Её сохранили в том же состоянии, что и при обнаружении тела. " << endl;
    system("pause");
    coridor(n);
}

void coridor(int n)
{
    system("cls");

    cout << "Вы в небольшой прихожей. Грязно также, как и в холле, но не видно никаких следов борьбы или иных улик, указывающих на совершение преступления.  \nМожет кто-то из работников мотеля подкараулил жертву? У них же есть ключи от номеров..." << endl;
    cout << "Можно пройти в ВАННУЮ(1), БАЛКОН(2), КОМНАТУ(3), ПОЗВОНИТЬ В ОТДЕЛ(4)";
    if (vrach1) {
        cout << ", \nПОЗВОНИТЬ В БОЛЬНИЦУ, В КОТОРУЮ ХОДИЛА ПОСТРАДАВШАЯ(5) или ЗАВЕРШИТЬ РАССЛЕДОВАНИЕ(6)" << endl;
    }
    else {
        cout << " или ЗАВЕРШИТЬ РАССЛЕДОВАНИЕ(5)" << endl;
    }
    do
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2 && n != 3 && n != 4 && n != 5 && (n != 6 || vrach1 == false));

    if (n == 1)
        bathroom(n);
    if (n == 2)
        kitchen(n);
    if (n == 3)
        room(n);
    if (n == 4)
        otdel(n);
    if (n == 5 && vrach1) {
        tel(n);
    }
    else {
        if (nesch1 == true && doch == true && vrach1 == true && vrach2 == true && vrach3 == true && otdel1 == true) {
            qvit(n);
        }
        else {
            system("cls");
            cout << "Пока что у Вас недостаточно зацепок" << endl;
            system("pause");
            coridor(n);
        }
    }
}
void room(int n) {
    system("cls");
    cout << "Вы видите перед собой прожженное сигаретами кресло. Видимо до этого в номере часто курили. \n Рядом с креслом на небольшом столике лежит вата и бинты. \n" << endl;
    vrach2 = true;
    cout << "ОСМОТРЕТЬСЯ (1) или ВЫЙТИ В ПРИХОЖУЮ(2)" << endl;
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    if (n == 1) {
        system("cls");
        cout << "Беспорядок всё усложняет. Непонятно, искали здесь что-то или девушка сама это устроила. \nЭто не похоже на разбойное нападение. Кажется, ничего не пропало. \nНо может стоит искать что-то конкретное? \n";
        cout << "ВВЕСТИ НАЗВАНИЕ ПРЕДМЕТА ДЛЯ ПОИСКА (1) или ВЫЙТИ В ПРИХОЖУЮ(2)" << endl;
        {
            cin >> n;
            if (n == 0) exit(0);
        } while (n != 1 && n != 2);
        if (n == 1) {
            poisk(n);
        }


        system("pause");
    }
    coridor(n);


}
void bathroom(int n) {
    system("cls");
    cout << "Здесь и было обнаружено тело, по оценкам криминалистов, его положили в ванну после убийства. Кому же нужна была эта девушка? \n" << endl;
    cout << "ОСМОТРЕТЬСЯ (1) или ВЫЙТИ В ПРИХОЖУЮ(2)" << endl;
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    if (n == 1) {
        system("cls");
        cout << "Ничего примечательного: стиральная машина, пустой крючок для полотенца, грязное зеркало и раковина. \nВозможно, Вы что-то упускаете? \n";
        nesch1 = true;
        system("pause");
    }
    coridor(n);

}
void kitchen(int n) {
    system("cls");
    cout << "Вы на балконе, на полу стоит пустая пепельница. \nСмотрите вниз и понимаете, что здесь невысоко, можно было бы спрыгнуть с балкона без повреждений. Может именно так и поступил убийца? \n" << endl;
    cout << "ОСМОТРЕТЬСЯ (1) или ВЫЙТИ В ПРИХОЖУЮ(2)" << endl;
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    if (n == 1) {
        system("cls");
        cout << "Записка оказывается признанием любви от некого Стефана. Он просит девушку не бросать его, а поехать вместе с ним во Флориду." << endl;
        cout << "В письме есть интересная информация : 'Я знаю, что это ты украла деньги, но я готов забыть об этом, если ты поедешь со мной'. Число на письме - 01.12.1990.  \n";
        doch = true;
        cout << "ОСМОТРЕТЬ МУСОРНОЕ ВЕДРО (1) или ВЫЙТИ В ПРИХОЖУЮ(2)" << endl;
        {
            cin >> n;
            if (n == 0) exit(0);
        } while (n != 1 && n != 2);
        if (n == 1) {
            system("cls");
            cout << "Среди прочего : пустая упаковка обезболивающих, пустая пачка из под чипсов и бутылка из под пива, \nкоробка печенья, порванный билет на самолет во Флориду на 03.12.1990" << endl;
            vrach1 = true;
        }
        system("pause");
    }
    coridor(n);

}
void otdel(int n) {
    system("cls");
    cout << "С помощью опроса постояльцев мотеля было установлено, \nчто за последние сутки в мотеле не было замечено ни одного подозрительного человека, новые постояльцы не заселялись. \nКроме жителей мотеля, здесь видели лишь хозяйку мотеля и горничную. \n";
    otdel1 = true;
    system("pause");
    coridor(n);
}

void poisk(int n) {
    system("cls");
    cout << "ВВЕСТИ НАЗВАНИЕ ПРЕДМЕТА ДЛЯ ПОИСКА(строчными букв) или ВЫЙТИ В КОРИДОР(2)" << endl;
    cin >> s;
    if (s == "2") {
        coridor(n);
    }
    if (s != "деньги")
    {

        cout << "Что-то не то" << endl;

        system("pause");
        poisk(n);
    }
    else
    {
        system("cls");
        cout << "Действительно, денег нигде нет. Но куда куда девушка могла их потратить? Судя по письму, речь идет о крупной сумме. \nЛибо их забрал тот, кто совершил это преступление, либо их украли уже позже. \nНо до Вас здесь были только сотрудники милиции…" << endl;
        cout << "Вы возвращаетесь в прихожую" << endl;
        vaza = true;
        system("pause");
        coridor(n);
    }

}
void qvit(int n) {
    system("cls");
    cout << "Кажется, у Вас есть версия события. Итак, что это было?" << endl;
    cout << "УБИЙСТВО(1) или НЕСЧАТСНЫЙ СЛУЧАЙ(2)" << endl;
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    if (n == 1) {
        system("cls");
        cout << "Действительно, это не может быть несчастным случаем. Смерть наступила до того, как девушка оказалось в ванной. \nНо кто мог соверишить убийство и украсть деньги?";
        ub(n);

    }
    else {
        system("cls");
        cout << "Похоже на то, но кто мог украсть деньги? " << endl;

        nesch(n);

    }

}
void ub(int n) {
    cout << "(1)Преступление совершила горничная \n(2)Преступление совершил Стефан \n(3)Преступление совершил один из постояльцев мотеля \n(4)Убийца - хозяйка мотеля!" << endl;
    do
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2 && n != 3 && n != 4);

    system("cls");

    switch (n)
    {
    case 1: cout << "К Вам в милицию позвонила до смерти напуганная женщина, с которой теперь занимаются психологи, а вы еще и обвинили ее в убийстве? Вам должно быть стыдно!"; exit(0);
    case 2: cout << "О, да! Любовь зла, оказывается любящий человек может пойти на преступление, когда на кону стоят деньги. \nВероятно, девушка хотела полететь к нему, но что-то пошло не так, она порвала билет на самолет и пустилась в бега. Но возлюбленный быстро нашёл её. \nПроникнуть в номер не составляло труда, ночью он поднялся по аварийной лестнице и через балкон проник в номер, а потом также скрылся. Никто и не заметил. \n Смерть произошла из-за удушья, вероятно, подушкой. После чего Стефан перенес тело в ванну. \nБлагодаря Вашим дедуктивным способностям его наконец удалось поймать. \nПоздравляем Вас!"; exit(0);
    case 3: cout << "Хорошая версия, контингент мотеля не самый приятный. Но у вас нет ни одной улики, указывающей на кого-то из постояльцев, с чего вы вообще это взяли?"; exit(0);
    case 4: cout << "Супер! Не нужно было вас повышать. Вы уволены."; exit(0);
    }
}
void nesch(int n) {
    cout << "(1)Какие деньги? \n(2)деньги украл участковый" << endl;
    do
    {
        cin >> n;
        if (n == 0) exit(0);
    } while (n != 1 && n != 2);

    system("cls");

    switch (n)
    {
    case 1: cout << "Вы очень плохой следователь"; exit(0);
    case 2: cout << "Не верно. Видимо, вы единственный недобросовестный сотрудник полиции в этом районе. "; exit(0);
    }

}
